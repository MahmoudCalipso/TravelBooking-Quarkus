# ============================================
# Quarkus Application Configuration
# Travel Platform Backend
# ============================================

# ============================================
# Application Information
# ============================================
quarkus.application.name=traveling-booking-backend
quarkus.application.version=1.0.0
quarkus.package.type=fast-jar

# ============================================
# HTTP Server Configuration
# ============================================
quarkus.http.port=8080
quarkus.http.host=0.0.0.0
quarkus.http.test-timeout=60s
quarkus.http.limits.max-body-size=100M
quarkus.http.limits.max-header-size=20K

# ============================================
# Database Configuration (PostgreSQL)
# ============================================
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${DB_USERNAME:travelplatform}
quarkus.datasource.password=${DB_PASSWORD:travelplatform}
quarkus.datasource.jdbc.url=${DB_URL:jdbc:postgresql://localhost:5432/travelplatform}
quarkus.datasource.jdbc.max-size=20
quarkus.datasource.jdbc.min-size=5
quarkus.datasource.jdbc.initial-size=5
quarkus.datasource.jdbc.acquire-increment=5
quarkus.datasource.jdbc.idle-timeout-minutes=10
quarkus.datasource.jdbc.max-lifetime-minutes=30
quarkus.datasource.jdbc.validation-query=SELECT 1

# ============================================
# Hibernate ORM Configuration
# ============================================
quarkus.hibernate-orm.database.generation=validate
quarkus.hibernate-orm.sql-load-script=import.sql
quarkus.hibernate-orm.log.sql=false
quarkus.hibernate-orm.statistics=false
quarkus.hibernate-orm.query.plan-cache-max-size=2048
quarkus.hibernate-orm.query.default-cache-mode=IGNORE_SELECTABLE

# ============================================
# Flyway Database Migration Configuration
# ============================================
quarkus.flyway.enabled=true
quarkus.flyway.locations=db/migration
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.baseline-version=0
quarkus.flyway.validate-on-migrate=true
quarkus.flyway.out-of-order=false
quarkus.flyway.clean-disabled=true

# ============================================
# JWT Security Configuration
# ============================================
# SECURITY NOTE: Private key should be loaded from environment variable or mounted secret
# Never commit private keys to version control
quarkus.smallrye-jwt.enabled=true
quarkus.smallrye-jwt.rsa-public-key.location=${JWT_PUBLIC_KEY_PATH:publicKey.pem}
quarkus.smallrye-jwt.rsa-private-key.location=${JWT_PRIVATE_KEY_PATH:privateKey.pem}
quarkus.smallrye-jwt.token.issuer=${JWT_ISSUER:https://travelplatform.com}
quarkus.smallrye-jwt.token.audience=${JWT_AUDIENCE:travel-platform}
quarkus.smallrye-jwt.token.lifespan=86400
quarkus.smallrye-jwt.claims.email=email
quarkus.smallrye-jwt.claims.role=role
quarkus.smallrye-jwt.claims.userId=userId
jwt.secret=${JWT_SECRET:change-me}
jwt.expiration=${JWT_EXPIRATION:900000}
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}
jwt.issuer=${JWT_ISSUER:https://travelplatform.com}
smallrye.jwt.verify.key=${jwt.secret}
smallrye.jwt.verify.algorithm=HS256

# ============================================
# Password Hashing Configuration
# ============================================
quarkus.security.password.hashing.algorithm=bcrypt
quarkus.security.password.hashing.bcrypt.cost=12

# ============================================
# CORS Configuration
# ============================================
# SECURITY NOTE: Avoid wildcards (*) in production. Use specific origins.
quarkus.http.cors=true
quarkus.http.cors.origins=${CORS_ORIGINS:http://localhost:3000,http://localhost:8080}
quarkus.http.cors.methods=GET,POST,PUT,PATCH,DELETE,OPTIONS
quarkus.http.cors.headers=Authorization,Content-Type,Accept,Origin,X-Requested-With
quarkus.http.cors.exposed-headers=Authorization,Content-Type
quarkus.http.cors.access-control-max-age=3600
quarkus.http.cors.access-control-allow-credentials=true

# ============================================
# OpenAPI/Swagger Configuration
# ============================================
quarkus.smallrye-openapi.path=/swagger
quarkus.smallrye-openapi.info-title=Travel Platform API
quarkus.smallrye-openapi.info-version=1.0.0
quarkus.smallrye-openapi.info-description=Enterprise-grade travel platform backend API with user management, accommodations, travel reels, bookings, reviews, events, chat and notifications.
quarkus.smallrye-openapi.info-contact-email=api@travelplatform.com
quarkus.smallrye-openapi.info-contact-name=Travel Platform API Team
quarkus.smallrye-openapi.info-contact-url=https://travelplatform.com
quarkus.smallrye-openapi.info-license-name=MIT
quarkus.smallrye-openapi.info-license-url=https://opensource.org/licenses/MIT
quarkus.smallrye-openapi.servers.url=http://localhost:8080
quarkus.smallrye-openapi.servers.description=Development Server
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.enable=true

# ============================================
# OAuth 2.0 / OpenID Connect Configuration (Multi-Tenant)
# ============================================
# NOTE: Quarkus OIDC requires tenant configuration for multiple providers
# Each provider is configured as a separate tenant

# Google OAuth Tenant
quarkus.oidc.google.auth-server-url=https://accounts.google.com
quarkus.oidc.google.client-id=${GOOGLE_CLIENT_ID:your-google-client-id}
quarkus.oidc.google.client-secret=${GOOGLE_CLIENT_SECRET:your-google-client-secret}
quarkus.oidc.google.scopes=openid,profile,email
quarkus.oidc.google.authentication.redirect-uri=${OAUTH_REDIRECT_URI:http://localhost:3000/auth/callback/google}

# Microsoft OAuth Tenant (Azure AD / Outlook)
quarkus.oidc.microsoft.auth-server-url=https://login.microsoftonline.com/common/v2.0
quarkus.oidc.microsoft.client-id=${MICROSOFT_CLIENT_ID:your-microsoft-client-id}
quarkus.oidc.microsoft.client-secret=${MICROSOFT_CLIENT_SECRET:your-microsoft-client-secret}
quarkus.oidc.microsoft.scopes=openid,profile,email
quarkus.oidc.microsoft.authentication.redirect-uri=${OAUTH_REDIRECT_URI:http://localhost:3000/auth/callback/microsoft}

# Apple OAuth Tenant
quarkus.oidc.apple.auth-server-url=https://appleid.apple.com
quarkus.oidc.apple.client-id=${APPLE_CLIENT_ID:your-apple-client-id}
quarkus.oidc.apple.client-secret=${APPLE_CLIENT_SECRET:your-apple-client-secret}
quarkus.oidc.apple.scopes=openid,profile,email
quarkus.oidc.apple.authentication.redirect-uri=${OAUTH_REDIRECT_URI:http://localhost:3000/auth/callback/apple}

# ============================================
# Firebase Configuration (Unified)
# ============================================
firebase.project-id=${FIREBASE_PROJECT_ID:travel-platform}
firebase.credentials.path=${FIREBASE_CREDENTIALS_PATH:firebase-service-account.json}
firebase.storage.bucket=${FIREBASE_STORAGE_BUCKET:travel-platform.appspot.com}
firebase.database-url=${FIREBASE_DATABASE_URL:https://travel-platform.firebaseio.com}
firebase.storage.url.expiration.minutes=${FIREBASE_URL_EXPIRATION_MINUTES:15}

# ============================================
# Google Cloud Storage Configuration
# ============================================
gcp.project.id=${GCP_PROJECT_ID:travel-platform}
gcp.storage.bucket=${GCP_STORAGE_BUCKET:travel-platform-storage}
gcp.credentials.path=${GCP_CREDENTIALS_PATH:/path/to/credentials.json}

# ============================================
# Stripe Payment Gateway Configuration
# ============================================
stripe.api.key=${STRIPE_API_KEY:sk_test_}
stripe.webhook.secret=${STRIPE_WEBHOOK_SECRET:whsec_}
stripe.currency=USD
stripe.success-url=${STRIPE_SUCCESS_URL:http://localhost:3000/payment/success}
stripe.cancel-url=${STRIPE_CANCEL_URL:http://localhost:3000/payment/cancel}

# ============================================
# SendGrid Email Service Configuration
# ============================================
sendgrid.api.key=${SENDGRID_API_KEY:your-sendgrid-api-key}
sendgrid.from.email=${SENDGRID_FROM_EMAIL:noreply@travelplatform.com}
sendgrid.from.name=${SENDGRID_FROM_NAME:Travel Platform}
sendgrid.template.base-url=${SENDGRID_TEMPLATE_URL:https://travelplatform.com}

# ============================================
# Twilio SMS Service Configuration
# ============================================
twilio.account.sid=${TWILIO_ACCOUNT_SID:your-twilio-account-sid}
twilio.auth.token=${TWILIO_AUTH_TOKEN:your-twilio-auth-token}
twilio.phone.number=${TWILIO_PHONE_NUMBER:+1234567890}

# ============================================
# Firebase Cloud Messaging Configuration
# ============================================
fcm.project.id=${FCM_PROJECT_ID:travel-platform}
fcm.credentials.json=${FCM_CREDENTIALS_JSON:firebase-service-account.json}

# ============================================
# Validation Configuration
# ============================================
quarkus.hibernate-validator.fail-fast=true
quarkus.hibernate-validator.method-validation.enabled=true

# ============================================
# Jackson JSON Configuration
# ============================================
quarkus.jackson.fail-on-unknown-properties=false
quarkus.jackson.serialization.write-dates-as-timestamps=false
quarkus.jackson.serialization.write-date-timestamps-as-nanoseconds=false
quarkus.jackson.time-zone=UTC
quarkus.jackson.default-property-inclusion=non_null

# ============================================
# Logging Configuration
# ============================================
quarkus.log.level=INFO
quarkus.log.category."com.travelplatform".level=DEBUG
quarkus.log.category."org.hibernate.SQL".level=WARN
quarkus.log.category."org.hibernate.type.descriptor.sql.BasicBinder".level=WARN
quarkus.log.category."io.quarkus".level=INFO
quarkus.log.min-level=DEBUG
quarkus.log.console.format=%d{HH:mm:ss.SSS} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.file.enable=true
quarkus.log.file.path=logs/application.log
quarkus.log.file.format=%d{yyyy-MM-dd HH:mm:ss.SSS} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.file.rotation.max-file-size=10M
quarkus.log.file.rotation.max-backup-index=10
quarkus.log.file.rotation.file-suffix=.zip

# ============================================
# MapStruct Configuration
# ============================================
quarkus.mapstruct.unmapped-target-policy=WARN
quarkus.mapstruct.unmapped-source-policy=WARN
quarkus.mapstruct.component-model=cdi

# ============================================
# Lombok Configuration
# ============================================
lombok.addLombokGeneratedAnnotation=true
lombok.anyConstructor.addConstructorProperties=true

# ============================================
# Rate Limiting Configuration
# ============================================
# NOTE: These are application-level configurations.
# Quarkus does NOT enforce rate limits automatically.
# Implement a Filter/Interceptor or use external rate limiting (Redis, API Gateway).
# Authentication endpoints: 5 attempts per 15 minutes per IP
rate.limit.auth.attempts=5
rate.limit.auth.window=15m

# File uploads: 10 uploads per hour per user
rate.limit.file-upload.attempts=10
rate.limit.file-upload.window=1h

# API calls: 1000 requests per hour per user
rate.limit.api.attempts=1000
rate.limit.api.window=1h

# Comments: 20 comments per hour per user
rate.limit.comment.attempts=20
rate.limit.comment.window=1h

# ============================================
# File Upload Configuration
# ============================================
# Maximum file sizes
file.upload.max-image-size=10M
file.upload.max-video-size=100M
file.upload.max-file-size=100M

# Allowed file types
file.upload.allowed-image-types=image/jpeg,image/png,image/gif,image/webp
file.upload.allowed-video-types=video/mp4,video/quicktime,video/x-msvideo,video/x-matroska

# ============================================
# Video Processing Configuration
# ============================================
video.ffmpeg.path=${FFMPEG_PATH:ffmpeg}
video.thumbnail.count=3
video.thumbnail.width=320
video.thumbnail.height=180
video.compression.bitrate=1000k
video.compression.codec=libx264
video.compression.format=mp4

# ============================================
# Cache Configuration (Quarkus Cache - Caffeine)
# ============================================
quarkus.cache.enabled=true
quarkus.cache.caffeine.maximum-size=10000
quarkus.cache.caffeine.expire-after-write=5M
quarkus.cache.caffeine.expire-after-access=1M

# ============================================
# Pagination Configuration
# ============================================
pagination.default.page=1
pagination.default.page-size=20
pagination.max.page-size=100

# ============================================
# Approval Workflow Configuration
# ============================================
approval.auto-approve=false
approval.notification.enabled=true
approval.notification.email.enabled=true

# ============================================
# Notification Configuration
# ============================================
notification.email.enabled=true
notification.push.enabled=true
notification.sms.enabled=false
notification.batch.size=100
notification.batch.interval=5m

# ============================================
# Recommendation Algorithm Configuration
# ============================================
recommendation.weight.rating=0.4
recommendation.weight.engagement=0.3
recommendation.weight.recency=0.2
recommendation.weight.distance=0.1
recommendation.trending.window=7d

# ============================================
# Pricing Configuration
# ============================================
pricing.service-fee-percentage=10.0
pricing.service-fee-minimum=5.00
pricing.service-fee-maximum=100.00
pricing.cleaning-fee-percentage=10.0
pricing.tax-rate=0.08
pricing.currency.default=USD

# ============================================
# Cancellation Policy Configuration
# ============================================
cancellation.flexible.refund-percentage=100
cancellation.flexible.hours-before-checkout=48
cancellation.moderate.refund-percentage=50
cancellation.moderate.hours-before-checkout=168
cancellation.strict.refund-percentage=0
cancellation.strict.hours-before-checkout=336

# ============================================
# Development Profile Configuration
# ============================================
%dev.quarkus.profile=dev
%dev.quarkus.hibernate-orm.database.generation=drop-and-create
%dev.quarkus.hibernate-orm.log.sql=true
%dev.quarkus.log.category."com.travelplatform".level=DEBUG
%dev.quarkus.log.category."org.hibernate.SQL".level=DEBUG
%dev.quarkus.log.category."org.hibernate.type.descriptor.sql.BasicBinder".level=TRACE

# ============================================
# Test Profile Configuration
# ============================================
%test.quarkus.profile=test
%test.quarkus.hibernate-orm.database.generation=drop-and-create
%test.quarkus.datasource.jdbc.url=jdbc:h2:mem:test;DB_CLOSE_DELAY=-1
%test.quarkus.datasource.db-kind=h2
%test.quarkus.flyway.enabled=false
%test.quarkus.log.category."com.travelplatform".level=DEBUG

# ============================================
# Production Profile Configuration
# ============================================
%prod.quarkus.profile=prod
%prod.quarkus.hibernate-orm.database.generation=validate
%prod.quarkus.hibernate-orm.log.sql=false
%prod.quarkus.log.category."com.travelplatform".level=INFO
%prod.quarkus.log.category."org.hibernate.SQL".level=WARN
%prod.quarkus.log.file.enable=true
%prod.quarkus.log.file.path=/var/log/travelplatform/application.log
